    # рисуем референсный спектр
    cmap = plt.get_cmap('turbo')  # 'nipy_spectral'turbo'
    norm = mpl.colors.Normalize(vmin=410, vmax=675)
    for L in np.arange(WL_min, WL_max, 1):
        ax_1.vlines(L, ymin=-0.3, ymax=-0.2, linewidth=2, color=cmap(norm(L)))

# вектор начальных приближений - значения, с которых начинается аппроксимация,
в само   функции указываются пределы аппроксимации
# 1 - нормировка по высоте (чем больше значение - тем выше функция может быть, смотрим по Y)
# 2 - положение максимума (то где находится экстремум функции, смотрим по X)
# 3 - величина, пропорциональная полуширине( насколько функция будет вытягниваться по пропорциям: меньше - уже и выше, больше - шире и ниже)

    test_np = np.array([
        [0.000130, 0.000004, 0.000606],
        [0.000146, 0.000004, 0.000681],
        [0.000164, 0.000005, 0.000765],
        [0.000184, 0.000006, 0.000860],
        [0.000207, 0.000006, 0.000967],
        [0.000232, 0.000007, 0.001086],
        [0.000261, 0.000008, 0.001221],
        [0.000293, 0.000009, 0.001373],
        [0.000329, 0.000010, 0.001544],
        [0.000370, 0.000011, 0.001734],
        [0.000415, 0.000012, 0.001946],
        [0.000464, 0.000014, 0.002178],
        [0.000519, 0.000016, 0.002436],
        [0.000582, 0.000017, 0.002732],
        [0.000655, 0.000020, 0.003078],
        [0.000742, 0.000022, 0.003486],
        [0.000845, 0.000025, 0.003975],
        [0.000965, 0.000028, 0.004541],
        [0.001095, 0.000032, 0.005158],
        [0.001231, 0.000035, 0.005803],
        [0.001368, 0.000039, 0.006450],
        [0.001502, 0.000043, 0.007083],
        [0.001642, 0.000047, 0.007746],
        [0.001802, 0.000052, 0.008501],
        [0.001996, 0.000057, 0.009414],
        [0.002236, 0.000064, 0.010550],
        [0.002535, 0.000072, 0.011966],
        [0.002893, 0.000082, 0.013656],
        [0.003301, 0.000094, 0.015588],
        [0.003753, 0.000106, 0.017730],
        [0.004243, 0.000120, 0.020050],
        [0.004762, 0.000135, 0.022511],
        [0.005330, 0.000152, 0.025203],
        [0.005979, 0.000170, 0.028280],
        [0.006741, 0.000192, 0.031897],
        [0.007650, 0.000217, 0.036210],
        [0.008751, 0.000247, 0.041438],
        [0.010029, 0.000281, 0.047504],
        [0.011422, 0.000319, 0.054120],
        [0.012869, 0.000357, 0.060998],
        [0.014310, 0.000396, 0.067850],
        [0.015704, 0.000434, 0.074486],
        [0.017147, 0.000473, 0.081362],
        [0.018781, 0.000518, 0.089154],
        [0.020748, 0.000572, 0.098540],
        [0.023190, 0.000640, 0.110200],
        [0.026207, 0.000725, 0.124613],
        [0.029783, 0.000825, 0.141702],
        [0.033881, 0.000941, 0.161304],
        [0.038468, 0.001070, 0.183257],
        [0.043510, 0.001210, 0.207400],
        [0.048996, 0.001362, 0.233692],
        [0.055023, 0.001531, 0.262611],
        [0.061719, 0.001720, 0.294775],
        [0.069212, 0.001935, 0.330799],
        [0.077630, 0.002180, 0.371300],
        [0.086958, 0.002455, 0.416209],
        [0.097177, 0.002764, 0.465464],
        [0.108406, 0.003118, 0.519695],
        [0.120767, 0.003526, 0.579530],
        [0.134380, 0.004000, 0.645600],
        [0.149358, 0.004546, 0.718484],
        [0.165396, 0.005159, 0.796713],
        [0.181983, 0.005829, 0.877846],
        [0.198611, 0.006546, 0.959439],
        [0.214770, 0.007300, 1.039050],
        [0.230187, 0.008086, 1.115367],
        [0.244880, 0.008909, 1.188497],
        [0.258777, 0.009768, 1.258123],
        [0.271808, 0.010664, 1.323930],
        [0.283900, 0.011600, 1.385600],
        [0.294944, 0.012573, 1.442635],
        [0.304897, 0.013583, 1.494804],
        [0.313787, 0.014630, 1.542190],
        [0.321645, 0.015715, 1.584881],
        [0.328500, 0.016840, 1.622960],
        [0.334351, 0.018007, 1.656405],
        [0.339210, 0.019214, 1.685296],
        [0.343121, 0.020454, 1.709875],
        [0.346130, 0.021718, 1.730382],
        [0.348280, 0.023000, 1.747060],
        [0.349600, 0.024295, 1.760045],
        [0.350147, 0.025610, 1.769623],
        [0.350013, 0.026959, 1.776264],
        [0.349287, 0.028351, 1.780433],
        [0.348060, 0.029800, 1.782600],
        [0.346373, 0.031311, 1.782968],
        [0.344262, 0.032884, 1.781700],
        [0.341809, 0.034521, 1.779198],
        [0.339094, 0.036226, 1.775867],
        [0.336200, 0.038000, 1.772110],
        [0.333198, 0.039847, 1.768259],
        [0.330041, 0.041768, 1.764039],
        [0.326636, 0.043766, 1.758944],
        [0.322887, 0.045843, 1.752466],
        [0.318700, 0.048000, 1.744100],
        [0.314025, 0.050244, 1.733559],
        [0.308884, 0.052573, 1.720858],
        [0.303290, 0.054981, 1.705937],
        [0.297258, 0.057459, 1.688737],
        [0.290800, 0.060000, 1.669200],
        [0.283970, 0.062602, 1.647529],
        [0.276721, 0.065278, 1.623413],
        [0.268918, 0.068042, 1.596022],
        [0.260423, 0.070911, 1.564528],
        [0.251100, 0.073900, 1.528100],
        [0.240847, 0.077016, 1.486111],
        [0.229851, 0.080266, 1.439522],
        [0.218407, 0.083667, 1.389880],
        [0.206812, 0.087233, 1.338736],
        [0.195360, 0.090980, 1.287640],
        [0.184214, 0.094918, 1.237422],
        [0.173327, 0.099046, 1.187824],
        [0.162688, 0.103367, 1.138761],
        [0.152283, 0.107885, 1.090148],
        [0.142100, 0.112600, 1.041900],
        [0.132179, 0.117532, 0.994198],
        [0.122570, 0.122674, 0.947347],
        [0.113275, 0.127993, 0.901453],
        [0.104298, 0.133453, 0.856619],
        [0.095640, 0.139020, 0.812950],
        [0.087300, 0.144676, 0.770517],
        [0.079308, 0.150469, 0.729445],
        [0.071718, 0.156462, 0.689914],
        [0.064581, 0.162718, 0.652105],
        [0.057950, 0.169300, 0.616200],
        [0.051862, 0.176243, 0.582329],
        [0.046282, 0.183558, 0.550416],
        [0.041151, 0.191273, 0.520338],
        [0.036413, 0.199418, 0.491967],
        [0.032010, 0.208020, 0.465180],
        [0.027917, 0.217120, 0.439925],
        [0.024144, 0.226735, 0.416184],
        [0.020687, 0.236857, 0.393882],
        [0.017540, 0.247481, 0.372946],
        [0.014700, 0.258600, 0.353300],
        [0.012162, 0.270185, 0.334858],
        [0.009920, 0.282294, 0.317552],
        [0.007967, 0.295051, 0.301338],
        [0.006296, 0.308578, 0.286169],
        [0.004900, 0.323000, 0.272000],
        [0.003777, 0.338402, 0.258817],
        [0.002945, 0.354686, 0.246484],
        [0.002425, 0.371699, 0.234772],
        [0.002236, 0.389288, 0.223453],
        [0.002400, 0.407300, 0.212300],
        [0.002926, 0.425630, 0.201169],
        [0.003837, 0.444310, 0.190120],
        [0.005175, 0.463394, 0.179225],
        [0.006982, 0.482940, 0.168561],
        [0.009300, 0.503000, 0.158200],
        [0.012149, 0.523569, 0.148138],
        [0.015536, 0.544512, 0.138376],
        [0.019477, 0.565690, 0.128994],
        [0.023993, 0.586965, 0.120075],
        [0.029100, 0.608200, 0.111700],
        [0.034815, 0.629346, 0.103905],
        [0.041120, 0.650307, 0.096667],
        [0.047985, 0.670875, 0.089983],
        [0.055379, 0.690842, 0.083845],
        [0.063270, 0.710000, 0.078250],
        [0.071635, 0.728185, 0.073209],
        [0.080462, 0.745464, 0.068678],
        [0.089740, 0.761969, 0.064568],
        [0.099456, 0.777837, 0.060788],
        [0.109600, 0.793200, 0.057250],
        [0.120167, 0.808110, 0.053904],
        [0.131114, 0.822496, 0.050747],
        [0.142368, 0.836307, 0.047753],
        [0.153854, 0.849492, 0.044899],
        [0.165500, 0.862000, 0.042160],
        [0.177257, 0.873811, 0.039507],
        [0.189140, 0.884962, 0.036936],
        [0.201169, 0.895494, 0.034458],
        [0.213366, 0.905443, 0.032089],
        [0.225750, 0.914850, 0.029840],
        [0.238321, 0.923735, 0.027712],
        [0.251067, 0.932092, 0.025694],
        [0.263992, 0.939923, 0.023787],
        [0.277102, 0.947225, 0.021989],
        [0.290400, 0.954000, 0.020300],
        [0.303891, 0.960256, 0.018718],
        [0.317573, 0.966007, 0.017240],
        [0.331438, 0.971261, 0.015864],
        [0.345483, 0.976022, 0.014585],
        [0.359700, 0.980300, 0.013400],
        [0.374084, 0.984092, 0.012307],
        [0.388640, 0.987418, 0.011302],
        [0.403378, 0.990313, 0.010378],
        [0.418312, 0.992812, 0.009529],
        [0.433450, 0.994950, 0.008750],
        [0.448795, 0.996711, 0.008035],
        [0.464336, 0.998098, 0.007382],
        [0.480064, 0.999112, 0.006785],
        [0.495971, 0.999748, 0.006243],
        [0.512050, 1.000000, 0.005750],
        [0.528296, 0.999857, 0.005304],
        [0.544692, 0.999305, 0.004900],
        [0.561209, 0.998326, 0.004534],
        [0.577821, 0.996899, 0.004202],
        [0.594500, 0.995000, 0.003900],
        [0.611221, 0.992601, 0.003623],
        [0.627976, 0.989743, 0.003371],
        [0.644760, 0.986444, 0.003141],
        [0.661570, 0.982724, 0.002935],
        [0.678400, 0.978600, 0.002750],
        [0.695239, 0.974084, 0.002585],
        [0.712059, 0.969171, 0.002439],
        [0.728828, 0.963857, 0.002309],
        [0.745519, 0.958135, 0.002197],
        [0.762100, 0.952000, 0.002100],
        [0.778543, 0.945450, 0.002018],
        [0.794826, 0.938499, 0.001948],
        [0.810926, 0.931163, 0.001890],
        [0.826825, 0.923458, 0.001841],
        [0.842500, 0.915400, 0.001800],
        [0.857933, 0.907006, 0.001766],
        [0.873082, 0.898277, 0.001738],
        [0.887894, 0.889205, 0.001711],
        [0.902318, 0.879782, 0.001683],
        [0.916300, 0.870000, 0.001650],
        [0.929799, 0.859861, 0.001610],
        [0.942798, 0.849392, 0.001564],
        [0.955278, 0.838622, 0.001514],
        [0.967218, 0.827581, 0.001459],
        [0.978600, 0.816300, 0.001400],
        [0.989386, 0.804795, 0.001337],
        [0.999549, 0.793082, 0.001270],
        [1.009089, 0.781192, 0.001205],
        [1.018006, 0.769155, 0.001147],
        [1.026300, 0.757000, 0.001100],
        [1.033983, 0.744754, 0.001069],
        [1.040986, 0.732422, 0.001049],
        [1.047188, 0.720004, 0.001036],
        [1.052467, 0.707497, 0.001021],
        [1.056700, 0.694900, 0.001000],
        [1.059794, 0.682219, 0.000969],
        [1.061799, 0.669472, 0.000930],
        [1.062807, 0.656674, 0.000887],
        [1.062910, 0.643845, 0.000843],
        [1.062200, 0.631000, 0.000800],
        [1.060735, 0.618155, 0.000761],
        [1.058444, 0.605314, 0.000724],
        [1.055224, 0.592476, 0.000686],
        [1.050977, 0.579638, 0.000645],
        [1.045600, 0.566800, 0.000600],
        [1.039037, 0.553961, 0.000548],
        [1.031361, 0.541137, 0.000492],
        [1.022666, 0.528353, 0.000435],
        [1.013048, 0.515632, 0.000384],
        [1.002600, 0.503000, 0.000340],
        [0.991368, 0.490469, 0.000307],
        [0.979331, 0.478030, 0.000283],
        [0.966492, 0.465678, 0.000265],
        [0.952848, 0.453403, 0.000252],
        [0.938400, 0.441200, 0.000240],
        [0.923194, 0.429080, 0.000230],
        [0.907244, 0.417036, 0.000221],
        [0.890502, 0.405032, 0.000212],
        [0.872920, 0.393032, 0.000202],
        [0.854450, 0.381000, 0.000190],
        [0.835084, 0.368918, 0.000174],
        [0.814946, 0.356827, 0.000156],
        [0.794186, 0.344777, 0.000136],
        [0.772954, 0.332818, 0.000117],
        [0.751400, 0.321000, 0.000100],
        [0.729584, 0.309338, 0.000086],
        [0.707589, 0.297850, 0.000075],
        [0.685602, 0.286594, 0.000065],
        [0.663810, 0.275625, 0.000057],
        [0.642400, 0.265000, 0.000050],
        [0.621515, 0.254763, 0.000044],
        [0.601114, 0.244890, 0.000039],
        [0.581105, 0.235334, 0.000036],
        [0.561398, 0.226053, 0.000033],
        [0.541900, 0.217000, 0.000030],
        [0.522600, 0.208162, 0.000028],
        [0.503546, 0.199549, 0.000026],
        [0.484744, 0.191155, 0.000024],
        [0.466194, 0.182974, 0.000022],
        [0.447900, 0.175000, 0.000020],
        [0.429861, 0.167223, 0.000018],
        [0.412098, 0.159646, 0.000016],
        [0.394644, 0.152278, 0.000014],
        [0.377533, 0.145126, 0.000012],
        [0.360800, 0.138200, 0.000010],
        [0.344456, 0.131500, 0.000008],
        [0.328517, 0.125025, 0.000005],
        [0.313019, 0.118779, 0.000003],
        [0.298001, 0.112769, 0.000001],
        [0.283500, 0.107000, 0.000000],
        [0.269545, 0.101476, 0.000000],
        [0.256118, 0.096189, 0.000000],
        [0.243190, 0.091123, 0.000000],
        [0.230727, 0.086265, 0.000000],
        [0.218700, 0.081600, 0.000000],
        [0.207097, 0.077121, 0.000000],
        [0.195923, 0.072825, 0.000000],
        [0.185171, 0.068710, 0.000000],
        [0.174832, 0.064770, 0.000000],
        [0.164900, 0.061000, 0.000000],
        [0.155367, 0.057396, 0.000000],
        [0.146230, 0.053955, 0.000000],
        [0.137490, 0.050674, 0.000000],
        [0.129147, 0.047550, 0.000000],
        [0.121200, 0.044580, 0.000000],
        [0.113640, 0.041759, 0.000000],
        [0.106465, 0.039085, 0.000000],
        [0.099690, 0.036564, 0.000000],
        [0.093331, 0.034201, 0.000000],
        [0.087400, 0.032000, 0.000000],
        [0.081901, 0.029963, 0.000000],
        [0.076804, 0.028077, 0.000000],
        [0.072077, 0.026329, 0.000000],
        [0.067687, 0.024708, 0.000000],
        [0.063600, 0.023200, 0.000000],
        [0.059807, 0.021801, 0.000000],
        [0.056282, 0.020501, 0.000000],
        [0.052971, 0.019281, 0.000000],
        [0.049819, 0.018121, 0.000000],
        [0.046770, 0.017000, 0.000000],
        [0.043784, 0.015904, 0.000000],
        [0.040875, 0.014837, 0.000000],
        [0.038073, 0.013811, 0.000000],
        [0.035405, 0.012835, 0.000000],
        [0.032900, 0.011920, 0.000000],
        [0.030564, 0.011068, 0.000000],
        [0.028381, 0.010273, 0.000000],
        [0.026345, 0.009533, 0.000000],
        [0.024453, 0.008846, 0.000000],
        [0.022700, 0.008210, 0.000000],
        [0.021084, 0.007624, 0.000000],
        [0.019600, 0.007085, 0.000000],
        [0.018237, 0.006591, 0.000000],
        [0.016987, 0.006138, 0.000000],
        [0.015840, 0.005723, 0.000000],
        [0.014791, 0.005343, 0.000000],
        [0.013831, 0.004996, 0.000000],
        [0.012949, 0.004676, 0.000000],
        [0.012129, 0.004380, 0.000000],
        [0.011359, 0.004102, 0.000000],
        [0.010629, 0.003839, 0.000000],
        [0.009939, 0.003589, 0.000000],
        [0.009288, 0.003354, 0.000000],
        [0.008679, 0.003134, 0.000000],
        [0.008111, 0.002929, 0.000000],
        [0.007582, 0.002738, 0.000000],
        [0.007089, 0.002560, 0.000000],
        [0.006627, 0.002393, 0.000000],
        [0.006195, 0.002237, 0.000000],
        [0.005790, 0.002091, 0.000000],
        [0.005410, 0.001954, 0.000000],
        [0.005053, 0.001825, 0.000000],
        [0.004717, 0.001704, 0.000000],
        [0.004403, 0.001590, 0.000000],
        [0.004109, 0.001484, 0.000000],
        [0.003834, 0.001384, 0.000000],
        [0.003576, 0.001291, 0.000000],
        [0.003334, 0.001204, 0.000000],
        [0.003109, 0.001123, 0.000000],
        [0.002899, 0.001047, 0.000000],
        [0.002704, 0.000977, 0.000000],
        [0.002523, 0.000911, 0.000000],
        [0.002354, 0.000850, 0.000000],
        [0.002197, 0.000793, 0.000000],
        [0.002049, 0.000740, 0.000000],
        [0.001911, 0.000690, 0.000000],
        [0.001781, 0.000643, 0.000000],
        [0.001660, 0.000600, 0.000000],
        [0.001547, 0.000559, 0.000000],
        [0.001440, 0.000520, 0.000000],
        [0.001340, 0.000484, 0.000000],
        [0.001246, 0.000450, 0.000000],
        [0.001158, 0.000418, 0.000000],
        [0.001076, 0.000389, 0.000000],
        [0.001000, 0.000361, 0.000000],
        [0.000929, 0.000335, 0.000000],
        [0.000862, 0.000311, 0.000000],
        [0.000801, 0.000289, 0.000000],
        [0.000743, 0.000269, 0.000000],
        [0.000690, 0.000249, 0.000000],
        [0.000640, 0.000231, 0.000000],
        [0.000594, 0.000215, 0.000000],
        [0.000552, 0.000199, 0.000000],
        [0.000512, 0.000185, 0.000000],
        [0.000476, 0.000172, 0.000000],
        [0.000442, 0.000160, 0.000000],
        [0.000411, 0.000149, 0.000000],
        [0.000383, 0.000138, 0.000000],
        [0.000357, 0.000129, 0.000000],
        [0.000332, 0.000120, 0.000000],
        [0.000310, 0.000112, 0.000000],
        [0.000289, 0.000104, 0.000000],
        [0.000269, 0.000097, 0.000000],
        [0.000252, 0.000091, 0.000000],
        [0.000235, 0.000085, 0.000000],
        [0.000219, 0.000079, 0.000000],
        [0.000205, 0.000074, 0.000000],
        [0.000191, 0.000069, 0.000000],
        [0.000178, 0.000064, 0.000000],
        [0.000166, 0.000060, 0.000000],
        [0.000155, 0.000056, 0.000000],
        [0.000145, 0.000052, 0.000000],
        [0.000135, 0.000049, 0.000000],
        [0.000126, 0.000045, 0.000000],
        [0.000117, 0.000042, 0.000000],
        [0.000110, 0.000040, 0.000000],
        [0.000102, 0.000037, 0.000000],
        [0.000095, 0.000034, 0.000000],
        [0.000089, 0.000032, 0.000000],
        [0.000083, 0.000030, 0.000000],
        [0.000078, 0.000028, 0.000000],
        [0.000072, 0.000026, 0.000000],
        [0.000067, 0.000024, 0.000000],
        [0.000063, 0.000023, 0.000000],
        [0.000059, 0.000021, 0.000000],
        [0.000055, 0.000020, 0.000000],
        [0.000051, 0.000018, 0.000000],
        [0.000048, 0.000017, 0.000000],
        [0.000044, 0.000016, 0.000000],
        [0.000042, 0.000015, 0.000000],
        [0.000039, 0.000014, 0.000000],
        [0.000036, 0.000013, 0.000000],
        [0.000034, 0.000012, 0.000000],
        [0.000031, 0.000011, 0.000000],
        [0.000029, 0.000011, 0.000000],
        [0.000027, 0.000010, 0.000000],
        [0.000026, 0.000009, 0.000000],
        [0.000024, 0.000009, 0.000000],
        [0.000022, 0.000008, 0.000000],
        [0.000021, 0.000007, 0.000000],
        [0.000019, 0.000007, 0.000000],
        [0.000018, 0.000006, 0.000000],
        [0.000017, 0.000006, 0.000000],
        [0.000016, 0.000006, 0.000000],
        [0.000015, 0.000005, 0.000000],
        [0.000014, 0.000005, 0.000000],
        [0.000013, 0.000005, 0.000000],
        [0.000012, 0.000004, 0.000000],
        [0.000011, 0.000004, 0.000000],
        [0.000010, 0.000004, 0.000000],
        [0.000010, 0.000003, 0.000000],
        [0.000009, 0.000003, 0.000000],
        [0.000008, 0.000003, 0.000000],
        [0.000008, 0.000003, 0.000000],
        [0.000007, 0.000003, 0.000000],
        [0.000007, 0.000002, 0.000000],
        [0.000006, 0.000002, 0.000000],
        [0.000006, 0.000002, 0.000000],
        [0.000005, 0.000002, 0.000000],
        [0.000005, 0.000002, 0.000000],
        [0.000005, 0.000002, 0.000000],
        [0.000004, 0.000002, 0.000000],
        [0.000004, 0.000001, 0.000000],
        [0.000004, 0.000001, 0.000000],
        [0.000004, 0.000001, 0.000000],
        [0.000003, 0.000001, 0.000000],
        [0.000003, 0.000001, 0.000000],
        [0.000003, 0.000001, 0.000000],
        [0.000003, 0.000001, 0.000000],
        [0.000003, 0.000001, 0.000000],
        [0.000002, 0.000001, 0.000000],
        [0.000002, 0.000001, 0.000000],
        [0.000002, 0.000001, 0.000000],
        [0.000002, 0.000001, 0.000000],
        [0.000002, 0.000001, 0.000000],
        [0.000002, 0.000001, 0.000000],
        [0.000002, 0.000001, 0.000000],
        [0.000001, 0.000001, 0.000000],
        [0.000001, 0.000000, 0.000000],
        [0.000001, 0.000000, 0.000000]])
